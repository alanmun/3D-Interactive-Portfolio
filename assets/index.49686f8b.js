import{M as t,G as e,a as n,R as o,V as s,S as i,b as a,C as r,c as d,T as l,B as c,d as h,P as w,W as p,e as m,f as u,A as y,g as b,O as g,h as f,i as x,L as v}from"./vendor.3ae14f8e.js";class M{constructor(o,s,i,a=null){this.isGroup=!1,this.distance=0,this.tilt=t.randInt(-70,10),this.theta=t.randFloat(0,6.28318530718),this.cameraIsAt=!1,this.entity=null,this.entityCloseUp=null,null!=a?this.entity=a:this.isGroup?this.entity=new e:this.entity=new n,this.entity.name=o,this.isGroup=s,this.distance=i}swapEntities(t){!1===this.cameraIsAt?(t.remove(this.entity),t.add(this.entityCloseUp),this.cameraIsAt=!0):(t.remove(this.entityCloseUp),t.add(this.entity),this.cameraIsAt=!1)}addMesh(t,e){this.isGroup?this.entity.add(new n(t,e)):(this.entity.geometry=t,this.entity.material=e)}setCloseUp(t){this.entityCloseUp=t}rotate(t,e,n){this.entity.rotation.x+=t,this.entity.rotation.y+=e,this.entity.rotation.z+=n}adjustOrbit(){let t;t=this.cameraIsAt?this.entityCloseUp:this.entity;t.position.x=this.distance*Math.cos(this.theta),t.position.y=this.distance*Math.sin(this.theta),t.position.z=this.tilt*Math.sin(this.theta),this.theta+=1/(.07*this.distance**2)}setName(t){this.entity.name=t}getName(){return this.entity.name}}var j,k;let z,C,E,A,L,I;(k=j||(j={}))[k.spawn=0]="spawn",k[k.blackHole=1]="blackHole",k[k.twitter=2]="twitter",k[k.autosage=3]="autosage",k[k.torus=4]="torus",k[k.moon=5]="moon";var F=new Audio("/assets/zoomout.73f18dd5.wav");F.volume=.9;var U=new Audio("/assets/background.dd42b1f0.mp3");U.volume=.65;var G=!1,S=!1,O=!1,D=!1,R=!1,T=new o,W=new s;const H={x:0,y:0,z:290};let V={isLocked:!1,target:null,name:0};function P(t){if(W.x=t.clientX/window.innerWidth*2-1,W.y=-t.clientY/window.innerHeight*2+1,T.setFromCamera(W,E),T.intersectObjects(C.children),T.ray.intersectsBox((new x).setFromObject(L.entity)))V={isLocked:!0,target:L.entity,name:2};else for(var e=T.intersectObjects(C.children),n=0;n<e.length;n++)if("star"!=e[n].object.name&&"skybox"!=e[n].object.name)return V.isLocked=!0,V.target=e[n].object,void("moon"==e[n].object.name?V.name=5:"black hole"==e[n].object.name?V.name=1:"torus"==e[n].object.name&&(V.name=4))}function q(t){if(0!=V.name){var e=t.which;32!=e&&27!=e||(Y(!1),X(V.name,!0),V={isLocked:!0,target:{position:H},name:0},F.play())}}function B(){console.log("Texture is loaded now")}function X(t,e){switch(e?(R=!1,E.rotation.y=0):(R=!0,E.rotation.y=1.57),t){case 1:case 5:break;case 2:e?L.swapEntities(C):(L.swapEntities(C),V.target=L.entityCloseUp);break;case 3:break;default:console.log("DEFAULT TRIGGERED!?!?!?!?")}}function Y(t=!0,e="730ms"){var n=document.getElementById("bg");return n.style.transitionDuration=e,n.style.opacity=t?"0":"1",!1}(new class{addStar(e=!1){const o=new i(t.randFloat(.25,.75),24,24),s=new a({color:new r("white")}),d=new n(o,s);let l,c,h,w,p,m;w=0==t.randInt(0,1)?-1:1,p=0==t.randInt(0,1)?-1:1,m=e||0==t.randInt(0,1)?-1:1;const u=700;l=t.randFloat(0,w*u),h=t.randFloat(0,m*u),c=Math.abs(h)>250||Math.abs(l)>250?t.randFloat(0,p*u):t.randFloat(250*p,p*u),d.position.set(l,c,h),d.name="star",z.add(d)}pinCameraToWorld(e){console.log(E.rotation.x+30*t.DEG2RAD),E.position.set(e.position.x,e.position.y+10,e.position.z)}adjustCamera(t,e=.08,n=.025){const o=E.position.x-t.position.x,s=E.position.y-t.position.y,i=E.position.z-t.position.z,a=.05,r=.05;let d=Math.abs(o);d>18?E.position.x-=o*e:d>5?(E.position.x-=o*a,G=!0):d>1?(E.position.x-=o*n,G=!0):d>.1?(E.position.x-=Math.sign(o)*r,G=!0):d>=0&&(E.position.x=t.position.x,G=!0);let l=Math.abs(s);l>18?E.position.y-=s*e:l>5?(E.position.y-=s*a,S=!0):l>1?(E.position.y-=s*n,S=!0):l>.1?(E.position.y-=Math.sign(s)*r,S=!0):l>=0&&(E.position.y=t.position.y,S=!0);let c=Math.abs(i);c>18?E.position.z-=i*e:c>5?(E.position.z-=i*a,O=!0):c>1?(E.position.z-=i*n,O=!0):c>.1?(E.position.z-=Math.sign(i)*r,O=!0):c>=0&&(E.position.z=t.position.z,O=!0),E.position.x==H.x&&E.position.y==H.y&&E.position.z==H.z?(V={isLocked:!1,target:null,name:0},console.log("Matched at spawn: "+E.position.x+"  "+H.x),G=!1,S=!1,O=!1,D=!1):G&&S&&O&&(0==D&&(Y(),setTimeout((function(){X(V.name,!1),Y(!1)}),1e3)),D=!0)}init(){let e;z=new d,document.body.addEventListener("mousemove",(function(){U.play()}));const o=new v,x=new l(o);let j=new c(2100,2100,2100),k=[new a({map:x.load("/assets/right.19f9b8b4.png",B)}),new a({map:x.load("/assets/left.06e25816.png",B)}),new a({map:x.load("/assets/top.14e60ce3.png",B)}),new a({map:x.load("/assets/bottom.8560bb79.png",B)}),new a({map:x.load("/assets/front.e060fa56.png",B)}),new a({map:x.load("/assets/back.1d924bd0.png",B)})];k.forEach((t=>t.side=h)),o.onLoad=()=>{console.log("Loaded skybox"),e=new n(j,k),e.name="skybox",z.add(e),window.onload=function(){const t=document.querySelector("#loading-screen");console.log(t)}};let F=(new l).load("/assets/moon.b246064f.jpg"),G=(new l).load("/assets/moonbumpmap.8e277ece.jpg");E=new w(60,window.innerWidth/window.innerHeight,.1,5e3),E.position.z=H.z,E.position.y=H.y,window.addEventListener("mousedown",P,!1),window.addEventListener("keydown",q,!1),A=new p({canvas:document.querySelector("#bg")}),A.setPixelRatio(window.devicePixelRatio),A.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(A.domElement);const S=new M("torus",!1,140);S.addMesh(new m(10,3,16,100),new u({color:16737095,flatShading:!1,roughness:0,wireframe:!1})),z.add(S.entity);const O=new y(new r("white"),1);z.add(O),new b(200,50);for(let t=0;t<600;t++)this.addStar();let D=new M("black hole",!1,0);D.addMesh(new i(6,128,128),new u({color:"black",roughness:0,metalness:1,flatShading:!1})),z.add(D.entity),console.log("/assets/twitter.f3599cc1.obj"),(new g).load("/assets/twitter.f3599cc1.obj",(function(t){t.traverse((function(t){t instanceof n&&(t.material=new u({color:4177151,roughness:0,metalness:0,flatShading:!1}),t.rotation.y+=7.5)})),L=new M("twitter",!0,90,t),L.setCloseUp(I),z.add(L.entity)}));let T=new f(64,96,32,32),W=new u({color:4177151,map:F,metalness:0,normalMap:G});W.side=h,function(t,e){let n=.5*t.parameters.width,o=new s(-n,0),i=new s(0,e),a=new s(n,0),r=(new s).subVectors(o,i),d=(new s).subVectors(i,a),l=(new s).subVectors(o,a),c=r.length()*d.length()*l.length()/(2*Math.abs(r.cross(l))),h=new s(0,e-c),w=2*((new s).subVectors(o,h).angle()-.5*Math.PI),p=t.attributes.uv,m=t.attributes.position,u=new s;for(let s=0;s<p.count;s++){let t=1-p.getX(s),e=m.getY(s);u.copy(a).rotateAround(h,w*t),m.setXYZ(s,u.x,e,-u.y)}m.needsUpdate=!0}(T,5),I=new n(T,W),I.rotation.x+=90*t.DEG2RAD;let X=new M("moon",!1,170);X.addMesh(new i(6,64,64),new u({color:"white",map:F,normalMap:F})),z.add(X.entity),C=z;const Y=()=>{requestAnimationFrame(Y),S.adjustOrbit(),X.adjustOrbit(),L.adjustOrbit(),S.rotate(.01,.005,.001),X.rotate(.001,.001,0),L.rotate(0,0,.002),V.isLocked&&(R?this.pinCameraToWorld(V.target):this.adjustCamera(V.target)),A.render(C,E)};Y()}}).init();
